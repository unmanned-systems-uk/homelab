version: 2

servers:
  homelab-infra:
    name: HomeLab Infrastructure
    description: Access HomeLab devices, credentials, services, SCPI equipment, and network configuration

    image: homelab-infra:latest

    tools:
      - name: homelab_list_devices
        description: List all devices in the HomeLab infrastructure
      - name: homelab_get_device
        description: Get detailed information about a specific device
      - name: homelab_list_scpi_equipment
        description: List all SCPI-enabled test equipment
      - name: homelab_get_scpi_connection
        description: Get SCPI connection details for a device
      - name: homelab_list_services
        description: List all services in the HomeLab
      - name: homelab_check_service_health
        description: Check the health of a service endpoint
      - name: homelab_list_networks
        description: List all networks/VLANs
      - name: homelab_list_firewall_rules
        description: List firewall rules
      - name: homelab_lookup_ip
        description: Look up what's allocated to an IP address
      - name: homelab_get_credentials
        description: Get credentials for a target (AUDIT LOGGED)
      - name: homelab_infrastructure_summary
        description: Get a summary of all HomeLab infrastructure

    metadata:
      category: infrastructure
      tags:
        - homelab
        - devices
        - scpi
        - networking

    # No volume mounts needed - connects to PostgreSQL over network

    # Environment for database connection
    environment:
      HOMELAB_DB_HOST: "10.0.1.251"
      HOMELAB_DB_PORT: "5433"
      HOMELAB_DB_NAME: "homelab_db"
      HOMELAB_DB_USER: "ccpm"

    # Secrets for sensitive data
    secrets:
      - HOMELAB_DB_PASSWORD
      - HOMELAB_DB_KEY
